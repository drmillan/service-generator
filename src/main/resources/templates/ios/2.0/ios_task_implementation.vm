//
//  ${methodUcase}Task.m
//  ${projectName}
//
//  Created by Mobivery
//  Copyright (c) 2012 Mobivery. All rights reserved.
//

#import "${methodUcase}Task.h"
#import "${projectName}Helper.h"
#import "${serviceName}Logic.h"

@implementation ${methodUcase}Task

+ (void) ${method}TaskForRequest:(${requestDTO} *)request completed:(void(^)(${responseDTO} *response))completedBlock error:(void(^)(NSError *error))errorBlock {

	[UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
		
	UIView *loadingView;
	if ([[${projectName}Helper sharedInstance] respondsToSelector:@selector(loadingViewForTasks)]) {
		loadingView = [[${projectName}Helper sharedInstance] loadingViewForTasks];
	}
				
	if (loadingView) {
		UIWindow* window = [UIApplication sharedApplication].keyWindow;
		[window addSubview:loadingView];
	}
	
	[[${serviceName}Logic sharedInstance] ${method}:request onSucces:^(${responseDTO} *response){
	
		[UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
		if (loadingView) {
			[loadingView removeFromSuperview];
		}
		if(completedBlock){
			completedBlock(response);
		}
		
	} onError:^(NSError *error){
	
		[UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
		if (loadingView) {
			[loadingView removeFromSuperview];
		}
		if(errorBlock) {
			errorBlock(error);
		}		
	}];
	
} 

@end