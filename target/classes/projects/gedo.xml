<!--
################################################################ 
	XML DE DEFINICIÓN DE SERVICIOS GEDO 
################################################################
-->

<protocol 
    javaServiceException="com.mobivery.gedo.ServiceException"
    javaServiceExceptionListener="com.mobivery.gedo.ServiceExceptionListener"    
    onSend="com.mobivery.gedo.GedoApplication.onSend" onReceive="com.mobivery.gedo.GedoApplication.onReceive" onError="com.mobivery.gedo.GedoApplication.onError" onTask="com.mobivery.gedo.GedoApplication.onTaskFinished">
	<messages>
	    <!-- ###################################### HELLO ###################################### -->
	    <message name="Hello" service="Gedo" method="hello" description="" type="Get">
	        <urlPattern>
				<url address="http://erp.gedo.es/mobivery/hello" />				
			</urlPattern>			
			<response>
			    <field name="csrfmiddlewaretoken" type="String" description=""/>
			    <field name="sessionid"	type="String" description=""/>
			</response>	        
	    </message>
		<!-- ###################################### LOGIN ###################################### -->
		<message name="Login" service="Gedo" method="login" description="" type="Post">
		    <urlPattern>
				<url address="http://erp.gedo.es/mobivery/login" />				
			</urlPattern>			
			<request>
			    <field name="username" type="String" description="Login"/>
			    <field name="password" type="String" description="Password"/> 
			    <field name="csrfmiddlewaretoken" type="string" description="Token"/>
			</request>
			<response>
			    <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
			    <field name="email" type="String" description="Email del usuario"/>
			</response>
		</message>
		<!-- ###################################### LOGOUT ############################## -->
		<message name="Logout" service="Gedo" method="logout" description="" type="Post">
		    <urlPattern>
				<url address="http://erp.gedo.es/mobivery/logout" />				
			</urlPattern>			
			<request>
			    <field name="csrfmiddlewaretoken" type="string" description="Token"/>
			</request>
			<response>
			    <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>			    
			</response>
		</message>
		<!-- ###################################### PRODUCT ############################## -->
		<message name="ProductDetails" service="Gedo" method="getProductDetails" description="" type="Get">
		    <urlPattern>
		        <url address="http://erp.gedo.es/mobivery/product?referencia=${referencia}"/>
		    </urlPattern>
		    <request>
		        <field name="referencia" type="String" description="Referencia del producto"/>
		    </request>
		    <response>
			    <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
			    <field name="product" type="ProductDTO" description="Detalle del producto"/>
		    </response>
		</message>
		<!-- ###################################### CATEGORIES ############################## -->
		<message name="Categories" service="Gedo" method="getCategories" description="" type="Get">
		    <urlPattern>
		        <url address="http://erp.gedo.es/mobivery/categories"/>
		    </urlPattern>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="categories" type="CategoryDTO*" description="subcategorias"/>		        
		    </response>
		</message>
		<!-- ###################################### CLIENTS ############################## -->
		<message name="Clients" service="Gedo" method="getClients" description="" type="Get">
		    <urlPattern>
		        <url address="http://erp.gedo.es/mobivery/clients"/>
		    </urlPattern>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="clients" type="ClientDTO*" description="clients"/>		        
		    </response>
		</message>
		<!-- ###################################### CLIENT DETAILS ######################### -->
		<message name="ClientDetails" service="Gedo" method="getClientDetails" description="" type="Get">
		    <urlPattern>
		        <url address="http://erp.gedo.es/mobivery/client?client_id=${clientId}"/>
		    </urlPattern>
		    <request type="ClientRequestDTO">
		        <field name="clientId" type="int" description="Id de cliente"/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="client" type="ClientDTO" description="client detail"/>	
		        <field name="estimates" type="ClientEstimateDTO*" description="Presupuestos"/>
		        <field name="expirations" type="ClientExpirationDTO*" description="Vencimientos"/>	 
		        <field name="orders" type="OrderDTO*" description="Pedidos"/>	        
		    </response>
		</message>
		<!-- ###################################### CLIENT AGENCIES ######################## -->
		<message name="ClientAgencies" service="Gedo" method="getClientAgencies" description="" type="Get">
			<urlPattern>
			    <url address="http://erp.gedo.es/mobivery/client_agencies?client_id=${clientId}"/>
			</urlPattern>	
			<request type="ClientRequestDTO">
		        <field name="clientId" type="int" description="Id de cliente"/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="agencies" type="ClientAgencyDTO*" description="Agencias"/>		        
		    </response>	    
		</message>
		<!-- ###################################### CLIENT Expirations ######################## -->
		<message name="ClientExpirations" service="Gedo" method="getClientExpirations" description="" type="Get">
			<urlPattern>
			    <url address="http://erp.gedo.es/mobivery/client_expirations?client_id=${clientId}"/>
			</urlPattern>	
			<request type="ClientRequestDTO">
		        <field name="clientId" type="int" description="Id de cliente"/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="expirations" type="ClientExpirationDTO*" description="Agencias"/>		        
		    </response>	    
		</message>
		<!-- ###################################### CLIENT Products ######################## -->
		<message name="ClientProducts" service="Gedo" method="getClientProducts" description="" type="Get">
		    <urlPattern>
			    <url address="http://erp.gedo.es/mobivery/client_data?client_id=${clientId}"/>
			</urlPattern>	
			<request type="ClientRequestDTO">
		        <field name="clientId" type="int" description="Id de cliente"/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="product" type="ClientProductDTO*" description="Agencias"/>		        
		    </response>	    
		</message>
		<!-- ###################################### CLIENT RISK ######################## -->
		<message name="ClientRisk" service="Gedo" method="getClientRisk" description="" type="Get">
			<urlPattern>
			    <url address="http://erp.gedo.es/mobivery/client_available_risk?client_id=${clientId}"/>
			</urlPattern>
			<request type="ClientRequestDTO">
		        <field name="clientId" type="int" description="Id de cliente"/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="available_risk" type="String" description="Riesgo disponible"/>		        
		    </response>	    
		</message>
		<!-- ###################################### CLIENT Estimate ######################## -->
		<message name="ClientEstimate" service="Gedo" method="getClientEstimates" description="" type="Get">
			<urlPattern>
			    <url address="http://erp.gedo.es/mobivery/budgets?client_id=${clientId}"/>
			</urlPattern>
			<request type="ClientRequestDTO">
		        <field name="clientId" type="int" description="Id de cliente"/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="budgets" type="ClientEstimateDTO*" description="Presupuestos"/>		        
		    </response>	    
		</message>
		<!-- ###################################### Payment methods ###################### -->
		<message name="PaymentMethods" service="Gedo" method="getPaymentMethods" description="" type="Get">
		    <urlPattern>
		        <url address="http://erp.gedo.es/mobivery/payments"/>
		    </urlPattern>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="payments" type="PaymentMethodDTO*" description="Métodos de pago"/>
		    </response>
		</message>
		<!-- ###################################### ALL Estimates ######################## -->
		<message name="Estimates" service="Gedo" method="getEstimates" description="" type="Get">
			<urlPattern>
			    <url address="http://erp.gedo.es/mobivery/budgets"/>
			</urlPattern>
			<response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="budgets" type="ClientEstimateDTO*" description="Presupuestos"/>		        
		    </response>	    
		</message>
		<!-- ###################################### Detalle Budget ######################## -->
		<message name="EstimateDetails" service="Gedo" method="getEstimateDetail" description="" type="Get">
			<urlPattern>
			    <url address="http://erp.gedo.es/mobivery/budget?budget_id=${budgetId}"/>
			</urlPattern>
			<request>
			    <field name="budgetId" type="int" description="Id del presupuesto"/>
			</request>
			<response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="budget" type="OrderDTO" description="Presupuestos"/>		        	        
		    </response>	    
		</message>
		<!-- ########################################## Create Budget ######################### -->
		<message name="CreateEstimate" service="Gedo" method="createEstimate" description="" type="PostJSON">
		 	<urlPattern>
		 	    <url address="http://erp.gedo.es/mobivery/create_budget"/>
		 	</urlPattern>   
		    <request style="JSON">
		        <field name="budget" type="EstimateDTO" description=""/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="budget_id" type="int" description="Id del presupuesto creado"/>		        
		    </response>		    
		</message>
		<!-- ########################################## Update Estimate ######################### -->
		<message name="UpdateEstimate" service="Gedo" method="updateEstimate" description="" type="PostJSON">
		 	<urlPattern>
		 	    <url address="http://erp.gedo.es/mobivery/update_budget"/>
		 	</urlPattern>   
		    <request style="JSON">
		        <field name="budget" type="EstimateDTO" description=""/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>		        
		    </response>		    
		</message>
		<!-- ########################################## Validate Estimate ######################### -->
		<message name="ValidateEstimate" service="Gedo" method="validateEstimate" description="" type="Post">
		 	<urlPattern>
		 	    <url address="http://erp.gedo.es/mobivery/validate_budget?budget_id=${budgetId}"/>
		 	</urlPattern>   
		    <request>
		        <field name="budgetId" type="String" description=""/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>		        
		    </response>		    
		</message>
		<!-- ########################################## Pedidos de cliente (Orders) ######################### -->
		<message name="ClientOrders" service="Gedo" method="getClientOrders" description="" type="Get">
		 	<urlPattern>
		 	    <url address="http://erp.gedo.es/mobivery/orders?client_id=${clientId}"/>
		 	</urlPattern>   
		    <request type="ClientRequestDTO">
		        <field name="clientId" type="int" description=""/>
		    </request>
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="orders" type="OrderDTO*" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>		        
		    </response>		    
		</message>		
		<!-- ########################################## Pedidos (Orders) ######################### -->
		<message name="Orders" service="Gedo" method="getOrders" description="" type="Get">
		 	<urlPattern>
		 	    <url address="http://erp.gedo.es/mobivery/orders"/>
		 	</urlPattern>   
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="orders" type="OrderDTO*" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>		        
		    </response>		    
		</message>
		<!-- ########################################## Pedidos (Orders) ######################### -->
		<message name="OrderDetails" service="Gedo" method="getOrderDetail" description="" type="Get">
		 	<urlPattern>
		 	    <url address="http://erp.gedo.es/mobivery/order?order_id=${order_id}"/>
		 	</urlPattern>
		 	<request>
		 	    <field name="order_id" type="int" description=""/>
		 	</request>   
		    <response>
		        <field name="status" type="String" description="Estado: SUCCESS, ACCESS_DENIED, INVALID_LOGIN"/>
		        <field name="order" type="OrderDTO"/>
		    </response>		    
		</message>
		
	</messages>
	<types>
	    <type name="ProductDTO">
	        <field name="id" type="int" description=""/>
	        <field name="name" type="String" description=""/>
	        <field name="referencia" type="String" description=""/>
	        <field name="image" type="String" description=""/>
	        <field name="precioclub1" type="double" description=""/>
	        <field name="precioclub2" type="double" description=""/>
	        <field name="precioclub3" type="double" description=""/>
	        <field name="importe_desde" type="double" description=""/>
	        <field name="pvp" type="double" description=""/>
	        <field name="unidades_por_caja" type="int" description=""/>
	        <field name="cantidad_minima_por_talla" type="int" description=""/>
	        <field name="cantidad_minima_pedido" type="int" description=""/>
	        <field name="tallaje" type="SizeDTO" description=""/>
	        <field name="combinaciones" type="SetDTO*" description="Combinaciones de color disponibles para el artículo."/>
	        <field name="composition" type="String" description="Composition"/>
	        <field name="stock" type="StockDTO*" description="Información de stock"/>
	    </type>
	    <type name="StockDTO">
	        <field name="codigo" type="String" description=""/>
	        <field name="talla_5XS" type="int" description=""/>
	      	<field name="talla_4XS" type="int" description=""/>
	      	<field name="talla_3XS" type="int" description=""/>
	      	<field name="talla_2XS" type="int" description=""/>
	      	<field name="talla_XS" type="int" description=""/>
	      	<field name="talla_S" type="int" description=""/>
	      	<field name="talla_M" type="int" description=""/>
	      	<field name="talla_L" type="int" description=""/>
	      	<field name="talla_XL" type="int" description=""/>
	      	<field name="talla_2XL" type="int" description=""/>
	      	<field name="talla_3XL" type="int" description=""/>
	      	<field name="talla_3" type="int" description=""/>
	      	<field name="talla_4" type="int" description=""/>
	      	<field name="talla_5" type="int" description=""/>
	      	<field name="talla_6" type="int" description=""/>
	      	<field name="talla_7" type="int" description=""/>
	      	<field name="talla_JUNIOR" type="int" description=""/>
	      	<field name="talla_BOY" type="int" description=""/>
	      	<field name="talla_SENIOR" type="int" description=""/>
	      	<field name="talla_58" type="int" description=""/>
	      	<field name="talla_62" type="int" description=""/>
	      	<field name="talla_64" type="int" description=""/>
	      	<field name="talla_UNI" type="int" description=""/>
	    </type>
	    
	    <type name="SizeDTO">
	        <field name="id" type="int" description="id de tallaje"/>
	        <field name="name" type="String" description="nombre del tallaje"/>
	        <field name="tallas" type="String*" descripton=" listado ordenado de tallas disponibles para el artículo. Ejemplo: [2XS, XS, S, M, L, XL, 2XL]"/>
	        <field name="categorias" type="String*" description="listado ordenado de categorias de jugador disponibles para el artículo. Ejemplo: [Benjamín, Alevín, Junior, Sénior]"/>
	        <field name="formula" type="SizeFormulaDTO*" description="para el cálculo de tallas a partir de las categorias de equipo debe usarse este array de objetos. Establece los porcentajes que deben aplicar-se en cada talla para una categoría dada. Los errores de redondeo se resuelven añadiendo o sustrayendo de la talla con mayor porcentaje"/>	        
	    </type>
	    <type name="FormulaDTO">
	        <field name="categoria" type="String" description="id del tallaje"/>
	        <field name="talla" type="String" description="nombre del tallaje"/>
	        <field name="porcentaje" type="double" description="tanto por ciento. Ejemplos: 50, 40, 70"/>
	    </type>
	    <type name="SetDTO">
	        <field name="codigo" type="String" description=""/>
	        <field name="image_list" type="String" description=""/>
	        <field name="image_details" type="String" description=""/>
	        <field name="colores" type="ColorDTO*" description=""/>
	    </type>
	    <type name="SizeFormulaDTO">
	        <field name="categoria" type="String" description=""/>
	        <field name="talla" type="String" description=""/>
	        <field name="porcentaje" type="double" description=""/>
	    </type>
	    <type name="ColorDTO">
	        <field name="rgb" type="String" description="Color RGB"/>
	        <field name="name" type="String" description="Nombre del color"/>
	    </type>
	    <type name="CategoryDTO">
	        <field name="image" type="String" description="Imagen de la categoria"/>
	        <field name="id" type="int" description="Id de la categoria"/>
	        <field name="name" type="String" description="Nombre de la categoria"/>
	        <field name="categories" type="CategoryDTO*" description="Subcategorias"/>
	        <field name="products" type="ProductDTO*" description="Productos"/>
	    </type>
	    <type name="ClientDTO">
	        <field name="zone" type="String" description="Zona"/>
	        <field name="id" type="int" description="Id"/>
	        <field name="code" type="int" description="Code"/>
	        <field name="ammount" type="double" description="Amount"/>
	        <field name="name" type="string" description="Nombre"/>
	    	<field name="risk" type="Double" description="Riesgo"/>
	        <field name="dni" type="String" description="DNI"/>
	        <field name="email" type="String" description="email"/>
	        <field name="phone" type="String" description="phone"/>
	        <field name="address" type="AddressDTO" description="direccion"/>	        
		</type>   
	    <type name="AddressDTO">
	        <field name="city" type="String" description="Ciudad"/>
	        <field name="region" type="String" description="Region"/>
	        <field name="street" type="String" description="Calle"/>
	        <field name="post_code" type="String" description="Codigo Postal"/>
	        <field name="country" type="String" description="Pais"/>
	    </type>
	    <type name="ClientAgencyDTO">
	        <field name="name" type="String" description="Nombre"/>
	        <field name="phone_number" type="String" description="PhoneNumber"/>	        
	    </type>
	    <type name="ClientExpirationDTO">
	        <field name="amount" type="double" description="Importe"/>
	        <field name="date" type="String" description="Fecha"/>	        
	    </type>
	    <type name="ClientProductDTO">
	        <field name="code" type="String" description="Código"/>
	        <field name="description" type="String" description="Descripción"/>
	        <field name="qty" type="double" description="Cantidad"/>	        
	    </type>
	     <type name="ClientEstimateDTO">
	        <field name="id" type="int" description="Código"/>
	        <field name="client" type="ClientDTO" description="Cliente"/>
	        <field name="ammount" type="double" description="Cantidad"/>
	       	<field name="date" type="String" description="Fecha"/>
	       	<field name="serial" type="String" description="Num Serie"/>
	    </type>
	    <type name="VendorDTO">
	        <field name="name" type="String" description=""/>
	        <field name="email" type="String" description=""/>
	        <field name="phone_number" type="String" description=""/>
	    </type>
	    <type name="ShipmentDTO">
	        <field name="name" type="String" description=""/>
	        <field name="address" type="AddressDTO" description=""/>
	        <field name="contact_phone_number" type="String" description=""/>
	        <field name="contact_name" type="String" description=""/>
	        <field name="delivery_hours" type="String" description=""/>
	    </type>
	    <type name="LineDTO">
	        <field name="product" type="EstimateProductDTO" description=""/>
	        <field name="productDetails" type="ProductDTO" description=""/>
	        <field name="quantities" type="QuantityDTO*" description=""/>
	        <field name="total" type="double" description=""/>
	        <field name="price" type="double" description=""/>
	        <field name="discount" type="String" description=""/>
	    </type>
	    <type name="EstimateProductDTO">
	       <field name="id" type="int" description=""/>
	       <field name="code" type="String" description=""/>
	       <field name="description" type="String" description=""/>
	       <field name="color" type="String" description=""/>
	       <field name="available" type="String" description=""/>
	       <field name="size" type="String" description=""/> 
	    </type>
	    <type name="QuantityDTO">
	        <field name="size" type="String" description=""/>
	        <field name="qty" type="int" description=""/>
	    </type>
	    <type name="PaymentDTO">
	        <field name="method" type="String" description=""/>
	        <field name="entity" type="String" description=""/>
	        <field name="ccc" type="String" description=""/>
	        <field name="payment_id" type="int" description=""/>
	        <field name="end_date" type="String" description=""/>
	        <field name="start_date" type="String" description=""/>
	        <field name="description" type="String" description=""/>
	        <field name="service" type="String" description=""/>
	        <field name="tarifa" type="String" description=""/>
	    </type>
	    <type name="EstimateDTO">
	        <field name="id" type="int" description=""/>
	        <field name="client" type="ClientDTO" description=""/>
	        <field name="lines" type="LineDTO*" description=""/>
	        <field name="payment_id" type="int" description=""/>
	        <field name="accept_link" type="string" description=""/>
	        <field name="reject_link" type="string" description=""/>        
	    </type>
	    <type name="OrderDTO">
	        <field name="id" type="int" description=""/>
	        <field name="client" type="ClientDTO" description=""/>
	        <field name="serial" type="String" description=""/>
	        <field name="date" type="String" description=""/>
			<field name="ammount" type="double" description=""/>
			<field name="discount" type="double" description=""/>
			<field name="shipping" type="double" description=""/>
			<field name="total" type="double" description=""/>
			<field name="vendor" type="VendorDTO" description=""/>
			<field name="shipment" type="ShipmentDTO" description=""/>
			<field name="print" type="boolean" description=""/>
			<field name="lines" type="LineDTO*" description=""/>
			<field name="payment" type="PaymentDTO" description=""/>        	        
	    </type>
	    <type name="ClientRequestDTO">
	        <field name="clientId" type="int" description=""/>
	    </type>
	    <type name="PaymentMethodDTO">
	       	<field name="payment_id" type="int" description=""/>
			<field name="description" type="String" description=""/>
			<field name="service" type="String" description=""/>
			<field name="tarifa" type="String" description=""/>
			<field name="importe_minimo_pedido" type="double" description=""/>
			<field name="end_date" type="String" description=""/>
			<field name="start_date" type="String" description=""/>									
	    </type>
	</types>
</protocol>